<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Bulls & Cows - Number Guessing Game</title>
    <!-- Modular CSS Files - Load in dependency order -->
    <link rel="stylesheet" href="/css/variables.css">
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/animations.css">
    <link rel="stylesheet" href="/css/components.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/game-regular.css">
    <link rel="stylesheet" href="/css/game-timeattack.css">
    <link rel="stylesheet" href="/css/game-daily.css">
    <link rel="stylesheet" href="/css/game-survival.css">
    <link rel="stylesheet" href="/css/game-multiplayer.css">
    <link rel="stylesheet" href="/css/modals.css">
    <link rel="stylesheet" href="/css/notifications.css">
    <link rel="stylesheet" href="/css/responsive.css">
    <link rel="stylesheet" href="/css/dark-mode.css">

    <!-- Font Awesome 6.5.1 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
</head>
<body>
    <div id="game-header">
        <h1 class="game-title" id="game-title-header">Bulls & Cows üéÆ</h1>
        <div id="controls">
            <!-- Notifications Bell (Always visible) -->
            <button id="notifications-bell" class="header-icon-btn" aria-label="Notifications" title="Notifications">
                <i class="fas fa-bell"></i>
                <span id="notifications-bell-badge" class="notification-bell-badge" style="display: none;">0</span>
            </button>

            <!-- Guest Controls (Visible when NOT logged in) -->
            <div id="guest-controls" style="display: none;">
                <button id="settings-btn" class="header-icon-btn" aria-label="Settings" title="Settings">
                    <i class="fas fa-sliders-h"></i>
                </button>
                <button id="login-btn" class="auth-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>LOGIN</span>
                </button>
            </div>

            <!-- User Controls (Visible when logged in) -->
            <div id="user-controls" style="display: none;">
                <!-- Win Streak Display -->
                <div id="streak-display" class="header-streak" data-tooltip="Current winning streak - win consecutive games to increase">
                    <i class="fas fa-bolt"></i>
                    <span id="win-streak-count">0</span>
                </div>

                <!-- Coin Display -->
                <div id="coin-display" class="header-coins" data-tooltip="Your coins - earn by winning games">
                    <i class="fas fa-coins"></i>
                    <span id="coin-count">0</span>
                </div>

                <!-- Profile Dropdown -->
                <div class="profile-dropdown-container">
                    <button id="profile-dropdown-btn" class="header-icon-btn" aria-label="Profile" title="Profile">
                        <i class="fas fa-gamepad"></i>
                    </button>
                    <div id="profile-dropdown" class="profile-dropdown" style="display: none;">
                        <div class="dropdown-user-info">
                            <div class="dropdown-avatar">
                                <i class="fas fa-gamepad"></i>
                            </div>
                            <div class="dropdown-user-details">
                                <div class="dropdown-username" id="dropdown-username">Username</div>
                                <div class="dropdown-email" id="dropdown-email">email@example.com</div>
                            </div>
                        </div>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="dropdown-view-profile">
                            <i class="fas fa-trophy"></i>
                            <span>View Profile</span>
                        </button>
                        <button class="dropdown-item" id="dropdown-settings">
                            <i class="fas fa-sliders-h"></i>
                            <span>Settings</span>
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="dropdown-logout">
                            <i class="fas fa-power-off"></i>
                            <span>Logout</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="game-container">
        <div id="game-status-display">
            <div id="game-status-icon"><i class="fas fa-trophy"></i></div>
            <h2 id="game-status-text">GAME READY</h2>
        </div>

        <div id="home-page">
            <!-- Mobile Tiles (shown only on mobile ‚â§768px) -->
            <div class="mobile-tiles-container">
                <div class="mode-tile daily-tile" data-mode="daily">
                    <div class="tile-icon">üåü</div>
                    <div class="tile-name">Daily Challenge</div>
                    <div class="tile-badge daily-badge" id="daily-challenge-tile-badge">LOADING...</div>
                </div>

                <div class="mode-tile multiplayer-tile" data-mode="multiplayer">
                    <div class="tile-icon">üéÆ</div>
                    <div class="tile-name">Multiplayer</div>
                    <div class="tile-badge multiplayer-badge">PvP</div>
                </div>

                <div class="mode-tile timeattack-tile" data-mode="timeattack">
                    <div class="tile-icon">‚ö°</div>
                    <div class="tile-name">Time Attack</div>
                    <div class="tile-badge timeattack-badge">5 MIN</div>
                </div>

                <div class="mode-tile survival-tile" data-mode="survival">
                    <div class="tile-icon">üíÄ</div>
                    <div class="tile-name">Survival</div>
                    <div class="tile-badge survival-badge">5 ROUNDS</div>
                </div>

                <div class="mode-tile practice-tile" data-mode="practice">
                    <div class="tile-icon">üéØ</div>
                    <div class="tile-name">Practice</div>
                    <div class="tile-badge practice-badge">RELAX</div>
                </div>
            </div>

            <!-- Desktop Banners (shown only on desktop >768px) -->
            <div class="desktop-banners-container">
                <!-- Daily Challenge Section -->
                <section class="section daily-challenge-banner">
                <div class="daily-challenge-header">
                    <h2>üåü DAILY CHALLENGE</h2>
                    <div class="daily-challenge-badge">TODAY</div>
                </div>
                <p class="daily-challenge-description">
                    Daily quest posted! All players face the same challenge.
                </p>
                <div id="daily-challenge-info" class="daily-challenge-info">
                    <div class="challenge-stat">
                        <i class="fas fa-calendar-day"></i>
                        <span id="challenge-date">Loading...</span>
                    </div>
                    <div class="challenge-stat">
                        <i class="fas fa-signal"></i>
                        <span id="challenge-difficulty">Loading...</span>
                    </div>
                    <div class="challenge-stat">
                        <i class="fas fa-users"></i>
                        <span id="challenge-players">0 players</span>
                    </div>
                </div>
                <div class="banner-actions">
                    <button id="play-daily-challenge" class="mode-play-btn daily-challenge-btn">
                        <i class="fas fa-play"></i> PLAY NOW
                    </button>
                    <button id="view-daily-leaderboard" class="mode-leaderboard-link">
                        <i class="fas fa-trophy"></i> Leaderboard
                    </button>
                </div>
                <div id="daily-challenge-status" style="display: none;" class="daily-challenge-status">
                    <!-- Will show user's result if already attempted -->
                </div>
            </section>

            <!-- Multiplayer Mode Banner -->
            <section class="section multiplayer-banner">
                <div class="multiplayer-header">
                    <h2>üéÆ MULTIPLAYER MODE</h2>
                    <div class="multiplayer-badge">1v1</div>
                </div>
                <p class="multiplayer-description">
                    Challenge your friends to a head-to-head race! First to solve wins!
                </p>
                <div class="banner-actions">
                    <button id="play-multiplayer" class="mode-play-btn multiplayer-btn">
                        <i class="fas fa-users"></i> PLAY NOW
                    </button>
                    <button id="multiplayer-stats-btn" class="mode-leaderboard-link">
                        <i class="fas fa-chart-bar"></i> STATS
                    </button>
                </div>
            </section>

            <!-- Time Attack Banner -->
            <section class="section time-attack-banner">
                <div class="time-attack-header">
                    <h2>‚ö° TIME ATTACK MODE</h2>
                    <div class="time-attack-badge">5 MIN</div>
                </div>
                <p class="time-attack-description">
                    Race the clock! Win as many as you can in 5 minutes!
                </p>
                <div class="banner-actions">
                    <button id="play-time-attack" class="mode-play-btn time-attack-btn">
                        <i class="fas fa-play"></i> PLAY NOW
                    </button>
                    <button id="view-time-attack-leaderboard" class="mode-leaderboard-link">
                        <i class="fas fa-trophy"></i> Leaderboard
                    </button>
                </div>
            </section>

            <!-- Survival Mode Banner -->
            <section class="section survival-banner">
                <div class="survival-header">
                    <h2>üíÄ SURVIVAL MODE</h2>
                    <div class="survival-badge">5 ROUNDS</div>
                </div>
                <p class="survival-description">
                    FIVE ROUNDS! ONE LIFE! Lose a round and your run ends!
                </p>
                <div class="banner-actions">
                    <button id="play-survival" class="mode-play-btn survival-btn">
                        <i class="fas fa-play"></i> PLAY NOW
                    </button>
                    <button id="view-survival-leaderboard" class="mode-leaderboard-link">
                        <i class="fas fa-trophy"></i> Leaderboard
                    </button>
                </div>
            </section>

            <section class="section practice-banner">
                <div class="practice-header">
                    <h2>üéØ PRACTICE MODE</h2>
                </div>
                <p class="practice-description">
                    Play at your own pace. No timers, no pressure!
                </p>
                <div class="button-group">
                    <button id="play-easy" class="difficulty-btn">EASY</button>
                    <button id="play-medium" class="difficulty-btn">MEDIUM</button>
                    <button id="play-hard" class="difficulty-btn">HARD</button>
                </div>
            </section>
            </div>
            <!-- End Desktop Banners -->

        </div>

        <!-- Time Attack Difficulty Modal -->
        <div id="time-attack-modal" class="difficulty-modal time-attack-theme" style="display: none;">
            <div class="difficulty-modal-content">
                <button class="modal-close-btn" aria-label="Close">&times;</button>
                <div class="modal-header">
                    <div class="modal-icon">‚ö°</div>
                    <h2>Time Attack</h2>
                    <p>Race against the clock! Choose your challenge level</p>
                </div>
                <div class="modal-difficulty-buttons">
                    <button class="modal-difficulty-btn easy-diff" data-mode="time-attack" data-difficulty="0">
                        <span class="diff-name">EASY</span>
                    </button>
                    <button class="modal-difficulty-btn medium-diff" data-mode="time-attack" data-difficulty="1">
                        <span class="diff-name">MEDIUM</span>
                    </button>
                    <button class="modal-difficulty-btn hard-diff" data-mode="time-attack" data-difficulty="2">
                        <span class="diff-name">HARD</span>
                    </button>
                </div>

                <!-- View Leaderboard Button -->
                <button class="modal-view-leaderboard-btn" data-mode="time-attack">
                    <span>üèÜ LEADERBOARD</span>
                </button>

                <!-- Leaderboard Section (Hidden, used in popup) -->
                <div class="modal-leaderboard-section">
                    <h3 class="modal-leaderboard-title">üèÜ EASY LEADERBOARD</h3>

                    <!-- Leaderboard Container -->
                    <div class="modal-leaderboard-container">
                        <div class="modal-leaderboard-loading">Loading top players...</div>
                        <div class="modal-leaderboard-list" style="display: none;">
                            <!-- Leaderboard entries will be dynamically inserted here -->
                        </div>
                        <div class="modal-leaderboard-empty" style="display: none;">
                            <i class="fas fa-trophy"></i>
                            <p>No players yet. Be the first!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Survival Difficulty Modal -->
        <div id="survival-modal" class="difficulty-modal survival-theme" style="display: none;">
            <div class="difficulty-modal-content">
                <button class="modal-close-btn" aria-label="Close">&times;</button>
                <div class="modal-header">
                    <div class="modal-icon">üíÄ</div>
                    <h2>Survival Mode</h2>
                    <p>Five rounds, one life! Choose your challenge level</p>
                </div>
                <div class="modal-difficulty-buttons">
                    <button class="modal-difficulty-btn easy-diff" data-mode="survival" data-difficulty="0">
                        <span class="diff-name">EASY</span>
                    </button>
                    <button class="modal-difficulty-btn medium-diff" data-mode="survival" data-difficulty="1">
                        <span class="diff-name">MEDIUM</span>
                    </button>
                    <button class="modal-difficulty-btn hard-diff" data-mode="survival" data-difficulty="2">
                        <span class="diff-name">HARD</span>
                    </button>
                </div>

                <!-- View Leaderboard Button -->
                <button class="modal-view-leaderboard-btn" data-mode="survival">
                    <span>üèÜ LEADERBOARD</span>
                </button>

                <!-- Leaderboard Section (Hidden, used in popup) -->
                <div class="modal-leaderboard-section">
                    <h3 class="modal-leaderboard-title">üèÜ EASY LEADERBOARD</h3>

                    <!-- Leaderboard Container -->
                    <div class="modal-leaderboard-container">
                        <div class="modal-leaderboard-loading">Loading top players...</div>
                        <div class="modal-leaderboard-list" style="display: none;">
                            <!-- Leaderboard entries will be dynamically inserted here -->
                        </div>
                        <div class="modal-leaderboard-empty" style="display: none;">
                            <i class="fas fa-trophy"></i>
                            <p>No players yet. Be the first!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Daily Challenge Modal -->
        <div id="daily-challenge-tile-modal" class="difficulty-modal daily-challenge-theme" style="display: none;">
            <div class="difficulty-modal-content">
                <button class="modal-close-btn" aria-label="Close">&times;</button>
                <div class="modal-header">
                    <div class="modal-icon">üåü</div>
                    <h2>Daily Challenge</h2>
                    <p id="daily-modal-description">Daily quest! All players face the same challenge</p>
                </div>
                <div id="daily-modal-info" class="daily-challenge-info">
                    <div class="challenge-stat">
                        <i class="fas fa-calendar-day"></i>
                        <span id="challenge-date-modal">Loading...</span>
                    </div>
                    <div class="challenge-stat">
                        <i class="fas fa-signal"></i>
                        <span id="challenge-difficulty-modal">Loading...</span>
                    </div>
                    <div class="challenge-stat">
                        <i class="fas fa-users"></i>
                        <span id="challenge-players-modal">0 players</span>
                    </div>
                </div>
                <div class="modal-tile-actions">
                    <button id="play-daily-tile" class="modal-tile-play-btn daily-challenge-btn">
                        <i class="fas fa-play"></i> PLAY NOW
                    </button>
                    <button id="view-daily-leaderboard-tile" class="modal-tile-secondary-btn">
                        <i class="fas fa-trophy"></i> Leaderboard
                    </button>
                </div>

                <!-- Leaderboard Section -->
                <div class="modal-leaderboard-section">
                    <h3 class="modal-leaderboard-title">üèÜ TODAY'S LEADERBOARD</h3>

                    <!-- Leaderboard Container (no tabs for daily - same challenge for everyone) -->
                    <div class="modal-leaderboard-container">
                        <div class="modal-leaderboard-loading">Loading top players...</div>
                        <div class="modal-leaderboard-list" style="display: none;">
                            <!-- Leaderboard entries will be dynamically inserted here -->
                        </div>
                        <div class="modal-leaderboard-empty" style="display: none;">
                            <i class="fas fa-trophy"></i>
                            <p>No players yet. Be the first!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Multiplayer Modal -->
        <div id="multiplayer-tile-modal" class="difficulty-modal multiplayer-theme" style="display: none;">
            <div class="difficulty-modal-content">
                <button class="modal-close-btn" aria-label="Close">&times;</button>
                <div class="modal-header">
                    <div class="modal-icon">üéÆ</div>
                    <h2>Multiplayer Mode</h2>
                    <p>Challenge your friends to a head-to-head race!</p>
                </div>
                <div class="modal-tile-actions">
                    <button id="play-multiplayer-tile" class="modal-tile-play-btn multiplayer-btn">
                        <i class="fas fa-users"></i> PLAY NOW
                    </button>
                    <button id="multiplayer-stats-tile" class="modal-tile-secondary-btn">
                        <i class="fas fa-chart-bar"></i> STATS
                    </button>
                </div>
            </div>
        </div>

        <!-- Practice Modal -->
        <div id="practice-tile-modal" class="difficulty-modal practice-theme" style="display: none;">
            <div class="difficulty-modal-content">
                <button class="modal-close-btn" aria-label="Close">&times;</button>
                <div class="modal-header">
                    <div class="modal-icon">üéØ</div>
                    <h2>Practice Mode</h2>
                    <p>Play at your own pace. No timers, no pressure!</p>
                </div>
                <div class="modal-difficulty-buttons">
                    <button id="play-easy-tile" class="modal-difficulty-btn easy-diff">
                        <span class="diff-name">EASY</span>
                    </button>
                    <button id="play-medium-tile" class="modal-difficulty-btn medium-diff">
                        <span class="diff-name">MEDIUM</span>
                    </button>
                    <button id="play-hard-tile" class="modal-difficulty-btn hard-diff">
                        <span class="diff-name">HARD</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="game-page" style="display: none;">
            <section class="section">
                <div class="game-header">
                    <h2>üîê ENTER YOUR GUESS</h2>
                    <div class="game-stats-inline">
                        <div class="stat-badge">
                            <span class="stat-icon">üéØ</span>
                            <span id="attempts">0</span>/10
                        </div>
                        <button id="hint-btn" class="hint-button" data-tooltip="Reveal one digit position">
                            <span class="hint-text">Hint</span> <span class="hint-cost" id="hint-cost">3</span> <i class="fas fa-coins"></i>
                        </button>
                    </div>
                </div>
                <div class="input-submit-wrapper">
                    <div id="input-container"></div>
                    <button id="submit-guess" class="submit-btn">
                        <span class="submit-text">‚ö° SUBMIT GUESS</span>
                        <span class="submit-icon">‚Üí</span>
                    </button>
                </div>

                <!-- Hints Display Container -->
                <div id="hints-container" class="hints-display" style="display: none;">
                    <h3>üí° Active Hints</h3>
                    <div id="hints-list" class="hints-list"></div>
                </div>
            </section>

            <section class="section">
                <h2>üìã GUESS HISTORY</h2>
                <div id="guess-history"></div>
            </section>

            <button id="quit-game">‚ùå QUIT GAME</button>
        </div>

        <!-- Daily Challenge Game Page -->
        <div id="daily-challenge-page" style="display: none;">
            <section class="section">
                <div class="game-header">
                    <h2>üåü TODAY'S CHALLENGE</h2>
                </div>
                <div class="input-submit-wrapper">
                    <div id="daily-input-container"></div>
                    <button id="submit-daily-guess" class="submit-btn">
                        <span class="submit-text">‚ö° SUBMIT GUESS</span>
                        <span class="submit-icon">‚Üí</span>
                    </button>
                </div>
            </section>

            <section class="section">
                <h2>üìã GUESS HISTORY</h2>
                <div id="daily-guess-history"></div>
            </section>

            <button id="quit-daily-challenge">‚ùå QUIT CHALLENGE</button>
        </div>

        <!-- Daily Challenge Result Page -->
        <div id="daily-result-page" class="card" style="display: none;">
            <div id="daily-game-stats"></div>
            <div class="result-button-group">
                <button id="view-daily-results-leaderboard">üèÜ LEADERBOARD</button>
                <button id="quit-daily-result">üè† MAIN MENU</button>
            </div>
        </div>

        <div id="result-page" class="card" style="display: none;">
            <div id="game-stats"></div>
            <div class="result-button-group">
                <button id="play-again">üîÅ PLAY AGAIN</button>
                <button id="quit">üè† MAIN MENU</button>
            </div>
        </div>

        <!-- Time Attack Game Page -->
        <div id="time-attack-page" style="display: none;">
            <section class="section">
                <div class="game-header">
                    <h2>‚ö° BEAT THE CLOCK</h2>
                    <div class="game-stats-inline">
                        <div class="stat-badge timer-countdown" id="ta-timer-badge">
                            <span class="stat-icon">‚è∞</span>
                            <span id="ta-timer">5:00</span>
                        </div>
                        <div class="stat-badge">
                            <span class="stat-icon">üèÜ</span>
                            <span id="ta-wins">0</span> wins
                        </div>
                        <button id="ta-hint-btn" class="hint-button" data-tooltip="Reveal one digit (+10s penalty)">
                            <span class="hint-text">Hint</span>
                            <span class="hint-cost" id="ta-hint-cost">10</span>
                            <i class="fas fa-coins"></i>
                        </button>
                    </div>
                </div>
                <div class="input-submit-wrapper">
                    <div id="ta-input-container"></div>
                    <button id="submit-ta-guess" class="submit-btn">
                        <span class="submit-text">‚ö° SUBMIT GUESS</span>
                        <span class="submit-icon">‚Üí</span>
                    </button>
                </div>
                <div id="ta-feedback" class="fade-in"></div>
                <div id="ta-hints-container" class="hints-display" style="display: none;">
                    <h3>üí° Active Hints</h3>
                    <div id="ta-hints-list" class="hints-list"></div>
                </div>
            </section>

            <section class="section">
                <h2>üìã GUESS HISTORY</h2>
                <div id="ta-guess-history"></div>
            </section>

            <button id="quit-time-attack" class="quit-btn">‚ùå END SESSION</button>
        </div>

        <!-- Time Attack Result Page -->
        <div id="time-attack-result-page" class="card" style="display: none;">
            <div id="time-attack-stats"></div>
            <div class="result-button-group">
                <button id="ta-play-again">üîÅ PLAY AGAIN</button>
                <button id="ta-main-menu">üè† MAIN MENU</button>
            </div>
        </div>

        <!-- Survival Mode Game Page -->
        <div id="survival-page" style="display: none;">
            <section class="section">
                <div class="game-header">
                    <h2>üíÄ SURVIVAL MODE</h2>
                    <div class="game-stats-inline">
                        <div class="stat-badge">
                            <span class="stat-icon">üìç</span>
                            <span id="survival-round-display">ROUND 1/5</span>
                        </div>
                        <div class="stat-badge">
                            <span class="stat-icon">üéØ</span>
                            <span id="survival-attempts-display">7/7</span>
                        </div>
                        <button id="survival-hint-btn" class="hint-button" data-tooltip="Reveal one digit position">
                            <span class="hint-text">Hint</span>
                            <span class="hint-cost" id="survival-hint-cost">10</span>
                            <i class="fas fa-coins"></i>
                        </button>
                    </div>
                </div>
                <div class="input-submit-wrapper">
                    <div id="survival-input-container"></div>
                    <button id="survival-submit-guess" class="submit-btn">
                        <span class="submit-text">‚ö° SUBMIT GUESS</span>
                        <span class="submit-icon">‚Üí</span>
                    </button>
                </div>
                <div id="survival-feedback" class="fade-in"></div>
                <div id="survival-hints-container" class="hints-display" style="display: none;">
                    <h3>üí° Active Hints</h3>
                    <div id="survival-hints-list" class="hints-list"></div>
                </div>
            </section>

            <section class="section">
                <h2>üìã GUESS HISTORY</h2>
                <div id="survival-guess-history"></div>
            </section>

            <button id="survival-quit-btn" class="quit-btn">‚ùå END SESSION</button>
        </div>

        <!-- Survival Mode Result Page -->
        <div id="survival-result-page" class="card" style="display: none;">
            <div id="survival-stats"></div>
            <div class="result-button-group">
                <button id="survival-play-again">üîÅ PLAY AGAIN</button>
                <button id="survival-main-menu">üè† MAIN MENU</button>
            </div>
        </div>

        <!-- Multiplayer Game Page -->
        <div id="multiplayer-tab" class="tab-content" style="display: none;">
            <div id="ws-connection-status" class="disconnected" style="display: none;">Connecting...</div>

            <!-- Friends View -->
            <div id="mp-friends-view">
                <!-- Tab Navigation -->
                <div class="mp-tabs-nav">
                    <button class="mp-tab-btn active" data-tab="friends">
                        <span class="tab-icon">üë•</span>
                        <span>Friends</span>
                    </button>
                    <button class="mp-tab-btn" data-tab="activity">
                        <span class="tab-icon">üîî</span>
                        <span>Activity</span>
                        <span class="mp-tab-badge" id="activity-badge" style="display: none;">0</span>
                    </button>
                </div>

                <!-- Friends Tab -->
                <div class="mp-tab-content active" id="tab-friends">
                    <!-- Friend Search -->
                    <div class="mp-section friend-search">
                        <div class="section-header">Find Friends</div>
                        <input type="text" id="friend-search-input" placeholder="Search users by username...">
                        <div id="user-search-results"></div>
                    </div>

                    <!-- Friends List -->
                    <div class="mp-section">
                        <div class="section-header">Your Friends</div>
                        <div id="friends-list"></div>
                    </div>
                </div>

                <!-- Activity Tab -->
                <div class="mp-tab-content" id="tab-activity">
                    <!-- Friend Requests -->
                    <div class="mp-section">
                        <div class="section-header">Friend Requests</div>
                        <div id="pending-requests"></div>
                    </div>

                    <!-- Incoming Challenges -->
                    <div class="mp-section">
                        <div class="section-header">Incoming Challenges</div>
                        <div id="pending-challenges"></div>
                    </div>

                    <!-- Sent Challenges -->
                    <div class="mp-section">
                        <div class="section-header">Sent Challenges</div>
                        <div id="sent-challenges"></div>
                    </div>
                </div>
            </div>

            <!-- Game View -->
            <div id="mp-game-view" style="display: none;">
                <section class="section">
                    <div class="game-header">
                        <h2>üéÆ 1v1 RACE</h2>
                        <div class="game-stats-inline">
                            <div class="stat-badge mp-vs-badge">
                                <span>üéÆ VS <span id="mp-opponent-name">Opponent</span></span>
                            </div>
                            <div class="stat-badge mp-attempts-badge">
                                <span>YOU: <span id="mp-my-attempts">0</span> üéØ</span>
                            </div>
                            <div class="stat-badge mp-opponent-attempts-badge">
                                <span>OPP: <span id="mp-opponent-attempts">0</span> ‚öîÔ∏è</span>
                            </div>
                        </div>
                    </div>
                    <div class="input-submit-wrapper">
                        <div id="mp-input-container"></div>
                        <button id="mp-submit-guess" class="submit-btn">
                            <span class="submit-text">‚ö° SUBMIT GUESS</span>
                            <span class="submit-icon">‚Üí</span>
                        </button>
                    </div>
                </section>

                <section class="section">
                    <h2>üìã GUESS HISTORY</h2>
                    <div id="mp-guess-history"></div>
                </section>

                <button id="mp-quit-game">‚ùå LEAVE GAME</button>
            </div>

            <!-- Multiplayer Result Page -->
            <div id="mp-result-page" class="card" style="display: none;">
                <div id="mp-game-stats"></div>
                <div class="result-button-group">
                    <button id="mp-back-to-lobby">üè† BACK TO LOBBY</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Challenge Modal -->
    <div id="challenge-modal" class="difficulty-modal multiplayer-theme" style="display: none;">
        <div class="difficulty-modal-content">
            <button class="modal-close-btn" aria-label="Close" onclick="MultiplayerGame.closeChallengeModal()">&times;</button>
            <div class="modal-header">
                <div class="modal-icon">üéÆ</div>
                <h2 id="challenge-modal-title">Challenge Friend</h2>
                <p>Choose difficulty for your 1v1 race!</p>
            </div>
            <div class="modal-difficulty-buttons">
                <button class="modal-difficulty-btn easy-diff" data-difficulty="0">
                    <span class="diff-name">EASY</span>
                </button>
                <button class="modal-difficulty-btn medium-diff" data-difficulty="1">
                    <span class="diff-name">MEDIUM</span>
                </button>
                <button class="modal-difficulty-btn hard-diff" data-difficulty="2">
                    <span class="diff-name">HARD</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Game Result Modal -->
    <div id="game-result-modal" class="game-result-modal">
        <div class="game-result-content">
            <h2 class="result-title">Result</h2>
            <p class="result-message">Message</p>
        </div>
    </div>

    <!-- Multiplayer Stats Modal -->
    <div id="multiplayer-stats-modal" class="difficulty-modal" style="display: none;">
        <div class="difficulty-modal-content">
            <button class="modal-close-btn" aria-label="Close">&times;</button>
            <div class="modal-header">
                <div class="modal-icon">üìä</div>
                <h2>Multiplayer Stats</h2>
                <p>Your 1v1 performance</p>
            </div>
            <div id="mp-stats-modal-content">
                <!-- Stats will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <button class="modal-close-btn" id="close-auth">
                <i class="fas fa-times"></i>
            </button>

            <!-- Login Form -->
            <div id="login-form" class="auth-form">
                <h2>üîê LOGIN</h2>
                <form id="login-form-element">
                    <div class="form-group">
                        <label for="login-username">USERNAME</label>
                        <input type="text" id="login-username" required placeholder="Enter username">
                    </div>
                    <div class="form-group">
                        <label for="login-password">PASSWORD</label>
                        <input type="password" id="login-password" required placeholder="Enter password">
                    </div>
                    <div id="login-error" class="error-message"></div>
                    <button type="submit" class="auth-submit-btn">‚ö° LOGIN</button>
                </form>
                <p class="auth-switch">New Player? <a href="#" id="show-signup">Register</a></p>
            </div>

            <!-- Signup Form -->
            <div id="signup-form" class="auth-form" style="display: none;">
                <h2>‚úì REGISTER</h2>
                <form id="signup-form-element">
                    <div class="form-group">
                        <label for="signup-username">USERNAME</label>
                        <input type="text" id="signup-username" required placeholder="Choose username">
                    </div>
                    <div class="form-group">
                        <label for="signup-email">EMAIL</label>
                        <input type="email" id="signup-email" required placeholder="your@email.com">
                    </div>
                    <div class="form-group">
                        <label for="signup-password">PASSWORD</label>
                        <input type="password" id="signup-password" required minlength="6" placeholder="Min 6 characters">
                    </div>
                    <div id="signup-error" class="error-message"></div>
                    <button type="submit" class="auth-submit-btn">‚úì REGISTER</button>
                </form>
                <p class="auth-switch">Already Registered? <a href="#" id="show-login">Login</a></p>
            </div>
        </div>
    </div>

    <!-- User Profile Modal -->
    <div id="profile-modal" class="modal" style="display: none;">
        <div class="modal-content profile-modal-content">
            <button class="modal-close-btn" id="close-profile">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="profile-title">üë§ YOUR PROFILE</h2>

            <!-- User Info Header -->
            <div id="profile-header" class="profile-header">
                <div class="profile-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="profile-user-info">
                    <h3 id="profile-username">Username</h3>
                    <p id="profile-email">email@example.com</p>
                    <p class="profile-join-date">Joined: <span id="profile-join-date">--</span></p>
                </div>
            </div>

            <!-- Stats Grid -->
            <div class="profile-stats-grid">
                <div class="profile-stat-card">
                    <div class="stat-icon-value">
                        <i class="fas fa-gamepad"></i>
                        <span class="stat-value" id="profile-total-games">0</span>
                    </div>
                    <span class="stat-label">Total Games</span>
                </div>
                <div class="profile-stat-card">
                    <div class="stat-icon-value">
                        <i class="fas fa-trophy"></i>
                        <span class="stat-value" id="profile-total-wins">0</span>
                    </div>
                    <span class="stat-label">Total Wins</span>
                </div>
                <div class="profile-stat-card">
                    <div class="stat-icon-value">
                        <i class="fas fa-percentage"></i>
                        <span class="stat-value" id="profile-win-rate">0%</span>
                    </div>
                    <span class="stat-label">Win Rate</span>
                </div>
                <div class="profile-stat-card">
                    <div class="stat-icon-value">
                        <i class="fas fa-star"></i>
                        <span class="stat-value" id="profile-best-score">--</span>
                    </div>
                    <span class="stat-label">Best Score</span>
                </div>
            </div>

            <!-- Streaks Section -->
            <div class="profile-section">
                <h3>üî• STREAKS</h3>
                <div class="profile-stats-grid">
                    <div class="profile-stat-card">
                        <div class="stat-icon-value">
                            <i class="fas fa-fire"></i>
                            <span class="stat-value" id="profile-current-streak">0</span>
                        </div>
                        <span class="stat-label">Current Win Streak</span>
                    </div>
                    <div class="profile-stat-card">
                        <div class="stat-icon-value">
                            <i class="fas fa-award"></i>
                            <span class="stat-value" id="profile-best-streak">0</span>
                        </div>
                        <span class="stat-label">Best Win Streak</span>
                    </div>
                    <div class="profile-stat-card">
                        <div class="stat-icon-value">
                            <i class="fas fa-calendar-check"></i>
                            <span class="stat-value" id="profile-play-days">0</span>
                        </div>
                        <span class="stat-label">Consecutive Days</span>
                    </div>
                    <div class="profile-stat-card">
                        <div class="stat-icon-value">
                            <i class="fas fa-calendar-alt"></i>
                            <span class="stat-value" id="profile-best-play-days">0</span>
                        </div>
                        <span class="stat-label">Best Day Streak</span>
                    </div>
                </div>
            </div>

            <!-- Difficulty Breakdown -->
            <div class="profile-section">
                <h3>üéØ DIFFICULTY BREAKDOWN</h3>
                <div class="difficulty-breakdown">
                    <div class="stat-box difficulty-box easy">
                        <span class="stat-label">EASY</span>
                        <span class="stat-number" id="profile-easy-rate">0%</span>
                        <span class="stat-detail"><span id="profile-easy-wins">0</span> / <span id="profile-easy-games">0</span> wins</span>
                    </div>
                    <div class="stat-box difficulty-box medium">
                        <span class="stat-label">MEDIUM</span>
                        <span class="stat-number" id="profile-medium-rate">0%</span>
                        <span class="stat-detail"><span id="profile-medium-wins">0</span> / <span id="profile-medium-games">0</span> wins</span>
                    </div>
                    <div class="stat-box difficulty-box hard">
                        <span class="stat-label">HARD</span>
                        <span class="stat-number" id="profile-hard-rate">0%</span>
                        <span class="stat-detail"><span id="profile-hard-wins">0</span> / <span id="profile-hard-games">0</span> wins</span>
                    </div>
                </div>
            </div>

            <!-- Achievements Section -->
            <div class="profile-section">
                <h3>üèÜ ACHIEVEMENTS</h3>

                <!-- Achievement Stats -->
                <div id="profile-achievements-stats" class="achievements-stats">
                    <div class="stat-box">
                        <span class="stat-number" id="profile-unlocked-count">0</span>
                        <span class="stat-label">Unlocked</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number" id="profile-total-count">19</span>
                        <span class="stat-label">Total</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number" id="profile-completion-percent">0%</span>
                        <span class="stat-label">Complete</span>
                    </div>
                </div>

                <!-- Achievement Tabs -->
                <div class="achievements-tabs">
                    <button class="achievement-tab active" data-filter="all">All</button>
                    <button class="achievement-tab" data-filter="unlocked">Unlocked</button>
                    <button class="achievement-tab" data-filter="locked">Locked</button>
                </div>

                <!-- Achievements List -->
                <div id="profile-achievements-list" class="achievements-list">
                    <!-- Achievements will be dynamically inserted here -->
                </div>
            </div>

            <!-- Recent Games -->
            <div class="profile-section">
                <h3>üéÆ RECENT GAMES</h3>
                <div class="recent-games-list" id="profile-recent-games">
                    <!-- Recent games will be inserted here -->
                </div>
            </div>

            <!-- Logout Button (Mobile & Desktop) -->
            <div class="profile-logout-section">
                <button id="profile-logout-btn" class="profile-logout-btn">
                    <i class="fas fa-power-off"></i>
                    <span>Logout</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal" style="display: none;">
        <div class="modal-content settings-modal-content">
            <button class="modal-close-btn" id="close-settings">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="settings-title">‚öôÔ∏è SETTINGS</h2>

            <div class="settings-section">
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">
                            <i class="fas fa-volume-up" id="volume-icon"></i>
                            <span>Sound Volume</span>
                        </div>
                        <div class="setting-description">Adjust gameplay sound effects</div>
                    </div>
                    <div class="volume-control">
                        <input type="range" id="volume-slider" min="0" max="100" value="70" class="volume-slider">
                        <span id="volume-percentage" class="volume-percentage">70%</span>
                    </div>
                </div>

                <!-- Theme Toggle -->
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-label">
                            <i class="fas fa-moon" id="theme-icon"></i>
                            <span>Dark Mode</span>
                        </div>
                        <div class="setting-description">Toggle dark/light theme</div>
                    </div>
                    <label class="theme-toggle-switch">
                        <input type="checkbox" id="theme-toggle-checkbox" aria-label="Toggle dark mode">
                        <span class="theme-toggle-slider"></span>
                    </label>
                </div>

                <!-- Gameplay Preferences Section -->
                <div class="setting-item clickable" id="gameplay-preferences-toggle">
                    <div class="setting-info">
                        <div class="setting-label">
                            <i class="fas fa-gamepad"></i>
                            <span>Gameplay Preferences</span>
                        </div>
                        <div class="setting-description">Customize your gaming experience</div>
                    </div>
                    <i class="fas fa-chevron-down toggle-arrow"></i>
                </div>

                <!-- Gameplay Preferences Content (Collapsible) -->
                <div id="gameplay-preferences-content" class="how-to-play-content" style="display: none;">

                    <!-- Auto-Submit Toggle -->
                    <div class="gameplay-setting-item">
                        <div class="gameplay-setting-info">
                            <div class="gameplay-setting-label">
                                <i class="fas fa-bolt"></i>
                                <span>Auto-Submit</span>
                            </div>
                            <div class="gameplay-setting-description">Automatically submit when all digits are filled</div>
                        </div>
                        <label class="gameplay-toggle-switch">
                            <input type="checkbox" id="auto-submit-toggle" aria-label="Toggle auto-submit">
                            <span class="gameplay-toggle-slider"></span>
                        </label>
                    </div>

                    <!-- Animations Toggle -->
                    <div class="gameplay-setting-item">
                        <div class="gameplay-setting-info">
                            <div class="gameplay-setting-label">
                                <i class="fas fa-magic"></i>
                                <span>Animations</span>
                            </div>
                            <div class="gameplay-setting-description">Show confetti and floating numbers effects</div>
                        </div>
                        <label class="gameplay-toggle-switch">
                            <input type="checkbox" id="animations-toggle" aria-label="Toggle animations" checked>
                            <span class="gameplay-toggle-slider"></span>
                        </label>
                    </div>

                </div>

                <!-- How to Play Section -->
                <div class="setting-item clickable" id="how-to-play-toggle">
                    <div class="setting-info">
                        <div class="setting-label">
                            <i class="fas fa-question-circle"></i>
                            <span>How to Play</span>
                        </div>
                        <div class="setting-description">Learn game rules and mechanics</div>
                    </div>
                    <i class="fas fa-chevron-down toggle-arrow"></i>
                </div>

                <!-- How to Play Content (Collapsible) -->
                <div id="how-to-play-content" class="how-to-play-content" style="display: none;">
                    <div class="rules-section">
                        <h4>üéØ Game Objective</h4>
                        <p>Guess the secret code before running out of attempts. The code contains unique digits only (no repeating numbers). Most modes have attempt limits, but Daily Challenge offers unlimited attempts (ranked by performance).</p>
                    </div>

                    <div class="rules-section">
                        <h4>‚ö° Difficulty Levels</h4>
                        <ul>
                            <li><strong>Easy:</strong> 3-digit code - Perfect for beginners</li>
                            <li><strong>Medium:</strong> 4-digit code - Moderate challenge</li>
                            <li><strong>Hard:</strong> 5-digit code - Expert level</li>
                        </ul>
                    </div>

                    <div class="rules-section">
                        <h4>üêÇ Understanding Results</h4>
                        <ul>
                            <li><strong>Bulls:</strong> Correct digit in the correct position</li>
                            <li><strong>Cows:</strong> Correct digit but in the wrong position</li>
                        </ul>
                        <div class="example-box">
                            <strong>Example:</strong><br>
                            Secret code: <code>123</code><br>
                            Your guess: <code>132</code><br>
                            Result: <strong>1 Bull</strong> (the "1" is correct) + <strong>2 Cows</strong> ("2" and "3" are in wrong positions)
                        </div>
                    </div>

                    <div class="rules-section">
                        <h4>üìä Scoring & Stats</h4>
                        <ul>
                            <li><strong>Best Score:</strong> Lowest number of attempts to win (lower is better)</li>
                            <li><strong>Win Streak:</strong> Consecutive games won without losing</li>
                            <li><strong>Achievements:</strong> Unlock badges by completing challenges</li>
                        </ul>
                    </div>

                    <div class="rules-section">
                        <h4>üí° Pro Tips</h4>
                        <ul>
                            <li>Start by testing different digits to find which are in the code</li>
                            <li>Use the bulls and cows feedback to narrow down positions</li>
                            <li>Keep track of digits you've already tested</li>
                            <li>Remember: each digit can only appear once!</li>
                        </ul>
                    </div>

                    <!-- Game Modes Section -->
                    <div class="rules-section">
                        <h4>üéÆ Game Modes</h4>
                        <p class="mode-description">Choose from 5 exciting game modes, each with unique rules and challenges:</p>

                        <!-- Practice Mode -->
                        <div class="game-mode-item clickable" data-mode="practice">
                            <div class="mode-header">
                                <div class="mode-info">
                                    <span class="mode-icon">üéØ</span>
                                    <span class="mode-name">Practice Mode</span>
                                </div>
                                <i class="fas fa-chevron-down mode-arrow"></i>
                            </div>
                            <div class="mode-content" style="display: none;">
                                <p><strong>Play at your own pace</strong> - No timers, no pressure! Perfect for learning and improving your skills.</p>
                                <ul>
                                    <li><strong>Attempts:</strong> 10 attempts per game (all difficulties)</li>
                                    <li><strong>Goal:</strong> Solve the code before running out of attempts</li>
                                    <li><strong>Scoring:</strong> Track your best scores and win streaks</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Daily Challenge -->
                        <div class="game-mode-item clickable" data-mode="daily">
                            <div class="mode-header">
                                <div class="mode-info">
                                    <span class="mode-icon">üóìÔ∏è</span>
                                    <span class="mode-name">Daily Challenge</span>
                                </div>
                                <i class="fas fa-chevron-down mode-arrow"></i>
                            </div>
                            <div class="mode-content" style="display: none;">
                                <p><strong>One challenge per day</strong> - Same puzzle for everyone! Compete on the global leaderboard.</p>
                                <ul>
                                    <li><strong>Attempts:</strong> Unlimited! Keep trying until you solve it</li>
                                    <li><strong>Frequency:</strong> New challenge every 24 hours (difficulty rotates daily)</li>
                                    <li><strong>Leaderboard:</strong> Shows all your attempted guesses - ranked by fewest attempts and fastest time</li>
                                    <li><strong>Special:</strong> Everyone plays the same code - compare your performance!</li>
                                    <li><strong>Strategy:</strong> You can complete it, but fewer attempts = higher rank!</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Time Attack -->
                        <div class="game-mode-item clickable" data-mode="timeattack">
                            <div class="mode-header">
                                <div class="mode-info">
                                    <span class="mode-icon">‚è±Ô∏è</span>
                                    <span class="mode-name">Time Attack</span>
                                </div>
                                <i class="fas fa-chevron-down mode-arrow"></i>
                            </div>
                            <div class="mode-content" style="display: none;">
                                <p><strong>Race against the clock!</strong> Win as many games as possible in 5 minutes.</p>
                                <ul>
                                    <li><strong>Time Limit:</strong> 5 minutes total</li>
                                    <li><strong>Attempts:</strong> Unlimited attempts (but watch the clock!)</li>
                                    <li><strong>Scoring:</strong> Points based on difficulty, attempts, and speed</li>
                                    <li><strong>Goal:</strong> Maximize your score by solving multiple puzzles quickly</li>
                                    <li><strong>Strategy:</strong> Balance speed vs accuracy - fewer attempts = more points!</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Survival Mode -->
                        <div class="game-mode-item clickable" data-mode="survival">
                            <div class="mode-header">
                                <div class="mode-info">
                                    <span class="mode-icon">üíÄ</span>
                                    <span class="mode-name">Survival Mode</span>
                                </div>
                                <i class="fas fa-chevron-down mode-arrow"></i>
                            </div>
                            <div class="mode-content" style="display: none;">
                                <p><strong>FIVE ROUNDS. ONE LIFE.</strong> Lose a single round and your run ends!</p>
                                <ul>
                                    <li><strong>Rounds:</strong> Must complete all 5 rounds</li>
                                    <li><strong>Attempts per Round:</strong>
                                        <ul class="nested-list">
                                            <li>Easy: 7 attempts</li>
                                            <li>Medium: 8 attempts</li>
                                            <li>Hard: 10 attempts</li>
                                        </ul>
                                    </li>
                                    <li><strong>Win Condition:</strong> Solve the code in each round</li>
                                    <li><strong>Lose Condition:</strong> Fail ANY round = Game Over</li>
                                    <li><strong>Rewards:</strong> Coins per round + completion bonus</li>
                                    <li><strong>Difficulty:</strong> Gets progressively harder as rounds increase</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Multiplayer Mode -->
                        <div class="game-mode-item clickable" data-mode="multiplayer">
                            <div class="mode-header">
                                <div class="mode-info">
                                    <span class="mode-icon">üéÆ</span>
                                    <span class="mode-name">Multiplayer Mode</span>
                                </div>
                                <i class="fas fa-chevron-down mode-arrow"></i>
                            </div>
                            <div class="mode-content" style="display: none;">
                                <p><strong>Head-to-head competition!</strong> Challenge your friends to a race. First to solve wins!</p>
                                <ul>
                                    <li><strong>Players:</strong> 1v1 competitive match</li>
                                    <li><strong>Attempts per Player:</strong>
                                        <ul class="nested-list">
                                            <li>Easy: 7 attempts</li>
                                            <li>Medium: 8 attempts</li>
                                            <li>Hard: 10 attempts</li>
                                        </ul>
                                    </li>
                                    <li><strong>Win Condition:</strong> Solve before your opponent</li>
                                    <li><strong>Draw:</strong> Both reach max attempts without solving = Draw</li>
                                    <li><strong>Real-time:</strong> See opponent's guess count live</li>
                                    <li><strong>Login Required:</strong> Must be logged in to play</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Account Management Section -->
                <div class="setting-item clickable" id="account-management-toggle">
                    <div class="setting-info">
                        <div class="setting-label">
                            <i class="fas fa-user-cog"></i>
                            <span>Account Management</span>
                        </div>
                        <div class="setting-description">Update password, email, or delete account</div>
                    </div>
                    <i class="fas fa-chevron-down toggle-arrow"></i>
                </div>

                <!-- Account Management Content (Collapsible) -->
                <div id="account-management-content" class="how-to-play-content" style="display: none;">

                    <!-- Change Password (Collapsible) -->
                    <div class="account-setting-item clickable" id="change-password-toggle">
                        <div class="account-setting-header">
                            <div class="account-setting-title">
                                <i class="fas fa-lock"></i>
                                <span>Change Password</span>
                            </div>
                            <i class="fas fa-chevron-down toggle-arrow"></i>
                        </div>
                    </div>
                    <div id="change-password-form" class="account-form-content" style="display: none;">
                        <div class="account-form">
                            <input type="password" id="current-password" placeholder="Current Password" class="account-input">
                            <input type="password" id="new-password" placeholder="New Password" class="account-input">
                            <input type="password" id="confirm-new-password" placeholder="Confirm New Password" class="account-input">
                            <div id="change-password-error" class="account-error"></div>
                            <button id="change-password-btn" class="account-btn">
                                <i class="fas fa-check"></i> Update Password
                            </button>
                        </div>
                    </div>

                    <!-- Change Email (Collapsible) -->
                    <div class="account-setting-item clickable" id="change-email-toggle">
                        <div class="account-setting-header">
                            <div class="account-setting-title">
                                <i class="fas fa-envelope"></i>
                                <span>Change Email</span>
                            </div>
                            <i class="fas fa-chevron-down toggle-arrow"></i>
                        </div>
                    </div>
                    <div id="change-email-form" class="account-form-content" style="display: none;">
                        <div class="account-form">
                            <input type="email" id="new-email" placeholder="New Email Address" class="account-input">
                            <input type="password" id="email-confirm-password" placeholder="Confirm Password" class="account-input">
                            <div id="change-email-error" class="account-error"></div>
                            <button id="change-email-btn" class="account-btn">
                                <i class="fas fa-check"></i> Update Email
                            </button>
                        </div>
                    </div>

                    <!-- Delete Account (Collapsible) -->
                    <div class="account-setting-item danger-zone clickable" id="delete-account-toggle">
                        <div class="account-setting-header">
                            <div class="account-setting-title">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span>Danger Zone</span>
                            </div>
                            <i class="fas fa-chevron-down toggle-arrow"></i>
                        </div>
                    </div>
                    <div id="delete-account-form" class="account-form-content danger-zone-content" style="display: none;">
                        <div class="account-form">
                            <p class="danger-warning">‚ö†Ô∏è This action cannot be undone. All your data will be permanently deleted.</p>
                            <input type="password" id="delete-confirm-password" placeholder="Enter Password to Confirm" class="account-input">
                            <div id="delete-account-error" class="account-error"></div>
                            <button id="delete-account-btn" class="account-btn danger-btn">
                                <i class="fas fa-trash-alt"></i> Delete My Account
                            </button>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>

    <!-- Notifications Modal -->
    <div id="notifications-modal" class="modal" style="display: none;">
        <div class="modal-content notifications-modal-content">
            <button class="modal-close-btn" id="close-notifications-modal">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="notifications-modal-title">üîî NOTIFICATIONS</h2>

            <div class="notifications-modal-section">
                <!-- Friend Requests -->
                <div class="notification-item clickable" data-type="friend-requests">
                    <div class="notification-header">
                        <div class="notification-info">
                            <span class="notification-icon">üë•</span>
                            <span class="notification-name">Friend Requests</span>
                            <span class="notification-badge" id="friend-requests-badge" style="display: none;">0</span>
                        </div>
                        <i class="fas fa-chevron-down notification-arrow"></i>
                    </div>
                    <div class="notification-list-container" style="display: none;">
                        <div id="friend-requests-list" class="notification-list">
                            <!-- Friend requests will be dynamically inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Challenge Notifications -->
                <div class="notification-item clickable" data-type="challenge-notifications">
                    <div class="notification-header">
                        <div class="notification-info">
                            <span class="notification-icon">‚öîÔ∏è</span>
                            <span class="notification-name">Challenge Invites</span>
                            <span class="notification-badge" id="challenge-notifications-badge" style="display: none;">0</span>
                        </div>
                        <i class="fas fa-chevron-down notification-arrow"></i>
                    </div>
                    <div class="notification-list-container" style="display: none;">
                        <div id="challenge-notifications-list" class="notification-list">
                            <!-- Challenge invites will be dynamically inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Daily Challenge Leaderboard Modal -->
    <div id="daily-leaderboard-modal" class="modal" style="display: none;">
        <div class="modal-content modal-content-wide">
            <button class="modal-close-btn" id="daily-leaderboard-modal-close">
                <i class="fas fa-times"></i>
            </button>

            <!-- Enhanced Header -->
            <div class="daily-leaderboard-modal-header">
                <div class="daily-leaderboard-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                <div class="daily-leaderboard-title-section">
                    <h2 class="daily-leaderboard-title">Daily Challenge Leaderboard</h2>
                    <p class="daily-leaderboard-subtitle">
                        <i class="fas fa-calendar-day" style="margin-right: 5px;"></i>
                        <span id="daily-leaderboard-date"></span>
                    </p>
                </div>
            </div>

            <div id="modal-daily-leaderboard-container">
                <div id="modal-daily-leaderboard-loading">Loading leaderboard...</div>
                <div id="modal-daily-leaderboard-content" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- Time Attack Leaderboard Modal -->
    <div id="time-attack-leaderboard-modal" class="modal" style="display: none;">
        <div class="modal-content modal-content-wide">
            <button class="modal-close-btn" id="ta-leaderboard-close">
                <i class="fas fa-times"></i>
            </button>

            <!-- Enhanced Header -->
            <div class="ta-leaderboard-modal-header">
                <div class="ta-leaderboard-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                <div class="ta-leaderboard-title-section">
                    <h2 class="ta-leaderboard-title">Time Attack Leaderboard</h2>
                    <p class="ta-leaderboard-subtitle">Top players across all difficulties</p>
                </div>
            </div>

            <!-- Difficulty Tabs -->
            <div class="leaderboard-tabs">
                <button class="lb-tab active" data-difficulty="0">Easy</button>
                <button class="lb-tab" data-difficulty="1">Medium</button>
                <button class="lb-tab" data-difficulty="2">Hard</button>
            </div>

            <div id="ta-leaderboard-container">
                <div id="ta-leaderboard-loading">Loading leaderboard...</div>
                <div id="ta-leaderboard-content" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- Survival Mode Leaderboard Modal -->
    <div id="survival-leaderboard-modal" class="modal" style="display: none;">
        <div class="modal-content modal-content-wide">
            <button class="modal-close-btn" id="survival-leaderboard-close">
                <i class="fas fa-times"></i>
            </button>

            <!-- Enhanced Header -->
            <div class="ta-leaderboard-modal-header">
                <div class="ta-leaderboard-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                <div class="ta-leaderboard-title-section">
                    <h2 class="ta-leaderboard-title">Survival Mode Leaderboard</h2>
                    <p class="ta-leaderboard-subtitle">Top survivors - best runs only</p>
                </div>
            </div>

            <!-- Difficulty Tabs -->
            <div class="leaderboard-tabs">
                <button class="lb-tab active" data-difficulty="0">Easy</button>
                <button class="lb-tab" data-difficulty="1">Medium</button>
                <button class="lb-tab" data-difficulty="2">Hard</button>
            </div>

            <div id="survival-leaderboard-container">
                <div id="survival-leaderboard-loading">Loading leaderboard...</div>
                <div id="survival-leaderboard-content" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- Achievement Notification Toast Container -->
    <div id="achievement-toast-container"></div>

    <!-- Modular JavaScript Files - Load in dependency order -->
    <script src="/js/config.js"></script>
    <script src="/js/state.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/js/achievements.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/ui.js"></script>
    <script src="/js/game-regular.js"></script>
    <script src="/js/game-timeattack.js"></script>
    <script src="/js/game-daily.js"></script>
    <script src="/js/game-survival.js"></script>
    <script src="/js/notifications.js"></script>

    <!-- SockJS and STOMP for WebSocket -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    <!-- Multiplayer Game -->
    <script src="/js/game-multiplayer.js"></script>

    <!-- Initialize all modules when DOM is ready -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            debug.log('üéÆ Bulls & Cows - Initializing game modules...');

            // Initialize modules in order
            if (typeof Utils !== 'undefined') {
                Utils.init();
                debug.log('‚úì Utils initialized');
            }

            if (typeof Auth !== 'undefined') {
                Auth.init();
                debug.log('‚úì Auth initialized');
            }

            if (typeof UI !== 'undefined') {
                UI.init();
                debug.log('‚úì UI initialized');
            }

            if (typeof RegularGame !== 'undefined') {
                RegularGame.init();
                debug.log('‚úì Regular Game initialized');
            }

            if (typeof TimeAttackGame !== 'undefined') {
                TimeAttackGame.init();
                debug.log('‚úì Time Attack initialized');
            }

            if (typeof DailyGame !== 'undefined') {
                DailyGame.init();
                debug.log('‚úì Daily Challenge initialized');
            }

            if (typeof SurvivalGame !== 'undefined') {
                SurvivalGame.init();
                debug.log('‚úì Survival Mode initialized');
            }

            if (typeof MultiplayerGame !== 'undefined') {
                // Note: MultiplayerGame.init() will be called when user clicks play button
                debug.log('‚úì Multiplayer Mode loaded');
            }

            if (typeof Achievements !== 'undefined') {
                Achievements.init();
                debug.log('‚úì Achievements initialized');
            }

            // Set initial game status to home
            if (typeof Utils !== 'undefined') {
                Utils.updateGameStatus('home');
            }

            // Prevent accidental page refresh/close during active games
            window.addEventListener('beforeunload', (e) => {
                const isGameActive =
                    document.getElementById('game-page')?.style.display !== 'none' ||
                    document.getElementById('daily-challenge-page')?.style.display !== 'none' ||
                    document.getElementById('time-attack-page')?.style.display !== 'none' ||
                    document.getElementById('survival-page')?.style.display !== 'none' ||
                    (GameState.timeAttack?.sessionId && GameState.timeAttack?.timerInterval) ||
                    (GameState.survival?.sessionId && !GameState.survival?.gameEnded);

                if (isGameActive) {
                    e.preventDefault();
                    e.returnValue = 'You have a game in progress. Are you sure you want to leave? Your progress will be lost.';
                    return e.returnValue;
                }
            });

            // Multiplayer button handler
            const playMultiplayerBtn = document.getElementById('play-multiplayer');
            if (playMultiplayerBtn) {
                playMultiplayerBtn.addEventListener('click', () => {
                    // Check if user is logged in first
                    if (!GameState.currentUser) {
                        // Show toast and open auth modal
                        if (Achievements) {
                            Achievements.showToast('Please log in to play multiplayer mode! üîë', 'info');
                        }
                        const authModal = document.getElementById('auth-modal');
                        if (authModal && Utils) {
                            Utils.openModalWithAnimation(authModal);
                        }
                        if (Auth && Auth.showLoginForm) {
                            Auth.showLoginForm();
                        }
                        return;
                    }

                    // User is logged in, proceed to multiplayer tab
                    const homePage = document.getElementById('home-page');
                    const multiplayerTab = document.getElementById('multiplayer-tab');

                    if (Utils && homePage && multiplayerTab) {
                        Utils.fadeOutElement(homePage, () => {
                            multiplayerTab.style.display = 'block';
                            Utils.fadeInElement(multiplayerTab);
                        });
                    }

                    if (typeof MultiplayerGame !== 'undefined') {
                        MultiplayerGame.init();
                    }

                    if (typeof Utils !== 'undefined') {
                        Utils.updateGameStatus('multiplayer');
                    }
                });
            }

            // Multiplayer tab switching
            const mpTabButtons = document.querySelectorAll('.mp-tab-btn');
            mpTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabName = button.dataset.tab;

                    // Remove active class from all buttons and contents
                    mpTabButtons.forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.mp-tab-content').forEach(content => {
                        content.classList.remove('active');
                    });

                    // Add active class to clicked button and corresponding content
                    button.classList.add('active');
                    const tabContent = document.getElementById(`tab-${tabName}`);
                    if (tabContent) {
                        tabContent.classList.add('active');
                    }
                });
            });

            // Multiplayer stats button handler
            const multiplayerStatsBtn = document.getElementById('multiplayer-stats-btn');
            const multiplayerStatsModal = document.getElementById('multiplayer-stats-modal');

            if (multiplayerStatsBtn && multiplayerStatsModal) {
                multiplayerStatsBtn.addEventListener('click', () => {
                    // Check if user is logged in
                    if (!GameState.currentUser) {
                        if (Achievements) {
                            Achievements.showToast('Please log in to view multiplayer stats! üîë', 'info');
                        }
                        const authModal = document.getElementById('auth-modal');
                        if (authModal && Utils) {
                            Utils.openModalWithAnimation(authModal);
                        }
                        if (Auth && Auth.showLoginForm) {
                            Auth.showLoginForm();
                        }
                        return;
                    }

                    multiplayerStatsModal.style.display = 'flex';
                    // Load stats if MultiplayerGame is available
                    if (typeof MultiplayerGame !== 'undefined' && MultiplayerGame.loadStats) {
                        MultiplayerGame.loadStats();
                    }
                });

                // Close modal on X button
                const closeBtn = multiplayerStatsModal.querySelector('.modal-close-btn');
                if (closeBtn) {
                    closeBtn.addEventListener('click', () => {
                        multiplayerStatsModal.style.display = 'none';
                    });
                }

                // Close on outside click
                multiplayerStatsModal.addEventListener('click', (e) => {
                    if (e.target === multiplayerStatsModal) {
                        multiplayerStatsModal.style.display = 'none';
                    }
                });

                // Close on ESC key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && multiplayerStatsModal.style.display === 'flex') {
                        multiplayerStatsModal.style.display = 'none';
                    }
                });
            }

            debug.log('üéÆ Bulls & Cows - All modules initialized successfully!');

            // Cleanup on page unload
            window.addEventListener('beforeunload', () => {
                if (GameState && GameState.timerInterval) {
                    clearInterval(GameState.timerInterval);
                }
                if (GameState && GameState.dailyChallenge && GameState.dailyChallenge.timerInterval) {
                    clearInterval(GameState.dailyChallenge.timerInterval);
                }
                if (GameState && GameState.timeAttack && GameState.timeAttack.timerInterval) {
                    clearInterval(GameState.timeAttack.timerInterval);
                }
            });
        });
    </script>

    <!-- Bottom Navigation Bar (Mobile Only) -->
    <nav id="bottom-nav" class="bottom-nav">
        <button class="bottom-nav-item" id="bottom-nav-profile" data-page="profile">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </button>
        <button class="bottom-nav-item active" id="bottom-nav-home" data-page="home">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </button>
        <button class="bottom-nav-item" id="bottom-nav-settings" data-page="settings">
            <i class="fas fa-cog"></i>
            <span>Settings</span>
        </button>
    </nav>

    <div id="confetti-container"></div>
</body>
</html>